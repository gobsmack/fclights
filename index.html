<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>Forest Creek Lights</title>
  <style>
  html, body, #viewDiv {
    padding: 0;
    margin: 0;
    height: 100%;
    width: 100%;
  }
</style>
<link rel="stylesheet" href="https://js.arcgis.com/4.5/esri/css/main.css">
<script src="https://js.arcgis.com/4.5/"></script>
<script>
  require([
    "esri/Map",
    "esri/views/MapView",
    "esri/Graphic",
    "esri/widgets/BasemapToggle",
    "dojo/domReady!"
  ], function (Map, MapView, Graphic, BasemapToggle) {

    var map = new Map({
      basemap: "osm"
    });

    var view = new MapView({
      container: "viewDiv",  // Reference to the scene div created in step 5
      map: map,  // Reference to the map object created before the scene
      zoom: 15,  // Sets zoom level based on level of detail (LOD)
      center: [-97.600682, 30.512881]  // Sets center point of view using longitude,latitude
    });

    var basemapToggle = new BasemapToggle({
      view: view,  // The view that provides access to the map's "streets" basemap
      nextBasemap: "satellite"  // Allows for toggling to the "hybrid" basemap
    });

    basemapToggle.on('toggle', function (event) {
      console.log("current basemap title: ", event.current.title);
      console.log("previous basemap title: ", event.previous.title);
    });

    createGraphic = function (x, y, title, desc, img) {

      formatImage = function (value, key, data) {
        var result = "images/" + value;
        return "<a href='" + result + "' target=_blank><img src='" + result + "' style='width:300px; height: auto;' /></a>";
      };

      // Create the graphic
      var graphic = new Graphic({
        symbol: {
          type: "simple-marker",  // autocasts as new SimpleMarkerSymbol()
          style: "diamond",
          color: "green",
          size: "18px",  // pixels
          outline: {  // autocasts as new SimpleLineSymbol()
            color: "red",
            width: 3  // points
          }
        },
        popupTemplate: {
          title: "{Title}",
          content: "<p>{Desc}</p><p>{Image:formatImage}</p>"
        },
        geometry: {
          type: "point",
          x: x,
          y: y
        },
        attributes: {
          Title: title,
          Desc: desc,
          Image: img
        }
      });

      return graphic;
    }

    var graphic = createGraphic(-97.605682, 30.507881, "123 Main St", "This is the best light display you can image. The Griswold family impresses every year.", "sample.jpg");

    // Add the graphic to the view's default graphics view
    // If adding multiple graphics, use addMany and pass in the array of graphics.
    view.graphics.add(graphic);

    view.ui.add(basemapToggle, "top-right");

  });

</script>
</head>

<body>
  <div id="viewDiv"></div>
</body>

</html>